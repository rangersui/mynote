# 规划存储模型

GaussDB支持行列混合存储。行存储是指将标按行存储到硬盘分区上，列存储是指将标按列存储到硬盘分区上，默认情况下为行存储。

![行存储和列存储的差异](./image/行存储和列存储的差异.png)

| 存储模型 | 优点 | 缺点 |
|:------- |:-----|:-----|
|行存储|数据被保存在一起，INSERT和UPDATE容易|选择即使只涉及几列，所有数据都会被读取|
|列存储|1. 查询时只有涉及到的列会被读取 2. 投影操作高效 3. 任何列都能作为索引|1. 选择完成时，被选择的列要重新组装 2. INSERT和UPDATE比较麻烦|

一般情况下，如果表的字段比较多，查询不涉及很多列则适合列存储。如果字段少，查询需要大部分字段，则行存储好。

|类型|场景|
|:-|:-|
|行存储|1.点查询（返回的记录少，基于索引的简单查询）2. 增删改比较多|
|列存储|1.统计分析类查询(关联或分组较多） 2. 即席查询（查询条件不确定，行存表扫描难以使用索引）|

## 行存表

一行的数据为连续的，适用于经常对数据进行更新。

```sql
CREATE TABLE customer_t1
(
    state_ID CHAR(2),
    STATE_NAME VARCHAR(40),
    area_ID NUMBER
);

drop table customer_t1;
```

## 列存表

数据按列进行存储，即一列所有数据是连续存储的。单列查询IO小，比行存表占用更小的存储空间，适合数据批量插入，更新较少并且以查询为主的统计分类场景。不适合点查询。

```sql
CREATE TABLE customer_t2
(
    state_ID CHAR(2),
    state_NAME VARCHAR2(40),
    area_ID NUMBER
)
WITH (ORIENTATION = COLUMN);

DROP TABLE customer_t2;
```